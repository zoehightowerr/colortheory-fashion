{% extends "layout.html" %}

{% block content %}
<body>

<div class="quiz-wrapper">
    <div class="quiz-header">
        <h1>QUIZ</h1>
        <span class="quiz-page-indicator">{{ question.page_number }}</span>
    </div>

    <div class="quiz-card">

        <img src="{{ question.image_url }}" alt="Character" class="question-image">


        <div class="speech-bubble">
            <p>{{ question.question_text }}</p>
        </div>

        <div class="options-container">
            {% for option in question.options %}
            <div class="color-dot"
                 style="background-color: {{ option.color }};"
                 onclick="checkAnswer('{{ option.is_correct }}', this)">
            </div>
            {% endfor %}
        </div>

        <div id="feedbackBox" class="feedback-box"><p id="feedbackText"></p></div>

        <button id="nextButton" class="next-button" onclick="window.location.href='{{ question.next_question }}'">Next</button>

    </div>
</div>

<script>
function checkAnswer(isCorrectStr, selectedOption) {
    const isCorrect = (isCorrectStr === 'True');
    const feedbackDiv = document.querySelector('.feedbackBox p');
    const nextButton = document.getElementById('nextButton');
    const options = document.querySelectorAll('.color-dot');



if (isCorrect) {
    fetch('/submit_answer', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ is_correct: true })
    });
} else {
    fetch('/submit_answer', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ is_correct: false })
    });
}

    feedbackText.innerHTML = isCorrect ? "{{ question.feedback_correct }}" : "{{ question.feedback_incorrect }}";
    feedbackBox.style.display = 'block';
    nextButton.style.display = 'block';

}
</script>

</body>
{% endblock %}
